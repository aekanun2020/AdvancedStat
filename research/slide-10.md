# สไลด์ที่ 10: สถานการณ์เริ่มต้น - การวิเคราะห์ข้อมูลโรงไฟฟ้า

ในอุตสาหกรรมผลิตไฟฟ้า องค์กรของเรามีข้อมูลโรงไฟฟ้า 300 แห่ง ซึ่งถูกแบ่งเป็น 2 กลุ่ม:
- กลุ่มประสิทธิภาพสูง: 150 แห่ง
- กลุ่มประสิทธิภาพต่ำ: 150 แห่ง

**ข้อมูลเบื้องต้นของแต่ละกลุ่ม (ก่อนการเปลี่ยนแปลง)**:

| ตัวแปร | กลุ่มประสิทธิภาพสูง | กลุ่มประสิทธิภาพต่ำ |
|--------|-------------------|-------------------|
| fuel_cost | 2.15 บาท/หน่วย | 3.75 บาท/หน่วย |
| capacity_MW | 420 MW | 580 MW |
| operational_hrs | 7,850 ชม./ปี | 6,400 ชม./ปี |

**ความจำเป็น**: องค์กรต้องการเข้าใจปัจจัยที่ส่งผลต่อประสิทธิภาพและสร้างแบบจำลองเพื่อประเมินโรงไฟฟ้าแต่ละแห่ง

# สไลด์ที่ 11: การสร้างแบบจำลอง Logistic Regression

**ขั้นตอนที่ 1**: องค์กรได้พัฒนาแบบจำลอง logistic regression จากข้อมูลในอดีต:

```
log(p/(1-p)) = -4.2 - 1.8×fuel_cost - 0.005×capacity_MW + 0.0003×operational_hrs
```

โดย p คือความน่าจะเป็นที่โรงไฟฟ้าจะอยู่ในกลุ่มประสิทธิภาพสูง

**ตัวอย่างการคำนวณ**: โรงไฟฟ้า A จากกลุ่มประสิทธิภาพสูง
- fuel_cost = 2.2 บาท/หน่วย
- capacity_MW = 410 MW
- operational_hrs = 7,900 ชั่วโมง/ปี

```
log(p/(1-p)) = -4.2 - 1.8×2.2 - 0.005×410 + 0.0003×7900
            = -4.2 - 3.96 - 2.05 + 2.37
            = -7.84

odds = e^(-7.84) = 0.00039
```

**ความจำเป็น**: องค์กรต้องการเก็บค่า odds ของแต่ละโรงไฟฟ้าไว้เพื่อใช้ประเมินผลกระทบเมื่อมีการเปลี่ยนแปลง

# สไลด์ที่ 12: การเปลี่ยนแปลงในอุตสาหกรรมและการทดสอบ t-test

**ขั้นตอนที่ 2**: เกิดการเปลี่ยนแปลงในอุตสาหกรรม ส่งผลให้ต้นทุนเชื้อเพลิง (fuel_cost) เพิ่มขึ้นโดยเฉลี่ย 1 บาท/หน่วย

**ค่าเฉลี่ยใหม่**:

| ตัวแปร | กลุ่มประสิทธิภาพสูง | กลุ่มประสิทธิภาพต่ำ |
|--------|-------------------|-------------------|
| fuel_cost | 3.15 บาท/หน่วย | 4.75 บาท/หน่วย |
| capacity_MW | 420 MW | 580 MW |
| operational_hrs | 7,850 ชม./ปี | 6,400 ชม./ปี |

**การทดสอบ t-test** (เพื่อตรวจสอบว่ายังมีความแตกต่างระหว่างกลุ่ม):
- คำนวณค่า pooled standard deviation: sp = 0.354
- คำนวณ standard error: SE = 0.041
- คำนวณ t-statistic: t = (3.15 - 4.75) / 0.041 = -39.02
- p-value ≈ 0 (< 0.001)

**ผลลัพธ์**: ยังคงมีความแตกต่างอย่างมีนัยสำคัญระหว่างกลุ่ม

**ความจำเป็น**: องค์กรต้องประเมินว่าการเปลี่ยนแปลงนี้จะมีผลต่อการจัดกลุ่มโรงไฟฟ้าหรือไม่

# สไลด์ที่ 13: การวิเคราะห์ผลกระทบด้วย Logistic Regression

**ขั้นตอนที่ 3**: องค์กรทำการวิเคราะห์ logistic regression อีกครั้งเพื่อปรับแบบจำลอง:

**แบบจำลองใหม่**:
```
log(p/(1-p)) = -3.8 - 1.7×fuel_cost - 0.004×capacity_MW + 0.0003×operational_hrs
```

**การคำนวณ Odds Ratio**:
- Odds Ratio ของ fuel_cost = e^(-1.7) = 0.183
  - แปลความ: เมื่อ fuel_cost เพิ่มขึ้น 1 หน่วย โอกาสที่โรงไฟฟ้าจะมีประสิทธิภาพสูงลดลง 81.7%
- Odds Ratio ของ capacity_MW = e^(-0.004) = 0.996
- Odds Ratio ของ operational_hrs = e^(0.0003) = 1.0003

**ความจำเป็น**: องค์กรต้องการ Odds Ratio เพื่อคำนวณผลกระทบของการเปลี่ยนแปลงต่อโรงไฟฟ้าแต่ละแห่ง

# สไลด์ที่ 14: การประเมินผลกระทบต่อการจัดกลุ่มโรงไฟฟ้า

**ขั้นตอนที่ 4**: ประเมินผลกระทบจากการเพิ่มขึ้นของ fuel_cost ต่อโรงไฟฟ้า A:

โรงไฟฟ้า A (เดิมอยู่ในกลุ่มประสิทธิภาพสูง):
- fuel_cost เพิ่มจาก 2.2 เป็น 3.2 บาท/หน่วย (เพิ่มขึ้น 1 บาท/หน่วย)
- capacity_MW = 410 MW (คงที่)
- operational_hrs = 7,900 ชั่วโมง/ปี (คงที่)
- odds เดิม = 0.00039 (คำนวณจากทุกตัวแปร)

**การคำนวณผลกระทบโดยใช้ odds ratio**:
```
odds ใหม่ = odds เดิม × (odds ratio)^ΔX
odds ใหม่ = 0.00039 × 0.183^1
odds ใหม่ = 0.00039 × 0.183
odds ใหม่ = 0.000071
```

**ความน่าจะเป็นใหม่**:
```
p = odds / (1 + odds) = 0.000071 / 1.000071 = 0.000071 (0.0071%)
```

**ผลสรุป**: 
- ก่อนการเปลี่ยนแปลง: โรงไฟฟ้า A มีค่า odds = 0.00039 และอยู่ในกลุ่มประสิทธิภาพสูง
- หลังการเปลี่ยนแปลง: โรงไฟฟ้า A มีค่า odds ลดลงเหลือ 0.000071 คิดเป็นโอกาสเพียง 0.0071% ที่จะอยู่ในกลุ่มประสิทธิภาพสูง

**ผลกระทบต่อการจัดกลุ่ม**: การเพิ่มขึ้นของต้นทุนเชื้อเพลิง 1 บาท/หน่วยมีผลกระทบอย่างมากต่อการจัดกลุ่ม โดยทำให้โรงไฟฟ้า A ที่เคยอยู่ในกลุ่มประสิทธิภาพสูงมีแนวโน้มที่จะเลื่อนไปอยู่ในกลุ่มประสิทธิภาพต่ำอย่างชัดเจน

**เงื่อนไขและหลักการสำคัญ**:
1. วิธีนี้ใช้ได้ภายใต้เงื่อนไข: มีการเปลี่ยนแปลงเฉพาะ fuel_cost ขณะที่ตัวแปรอื่นคงที่
2. เราใช้ odds เดิมที่คำนวณจากทุกตัวแปร คูณกับ odds ratio ของตัวแปรที่เปลี่ยนแปลง
3. หลักการนี้เป็นคุณสมบัติของแบบจำลอง logistic regression ที่ช่วยให้ประเมินผลกระทบได้อย่างรวดเร็ว
4. ค่า odds ratio นี้แสดงอิทธิพลเฉพาะของการเปลี่ยนแปลง fuel_cost โดยไม่เกี่ยวข้องกับตัวแปรอื่น

**ความจำเป็น**: องค์กรต้องเตรียมมาตรการรองรับการเปลี่ยนแปลงการจัดกลุ่มโรงไฟฟ้าและวางแผนปรับปรุงประสิทธิภาพการทำงาน

# สไลด์ที่ 15: สรุปกระบวนการและประโยชน์

**สรุปกระบวนการวิเคราะห์**:
1. **เริ่มต้น**: มีข้อมูลโรงไฟฟ้า 2 กลุ่ม → สร้างแบบจำลอง → คำนวณและเก็บค่า odds
2. **เมื่อมีการเปลี่ยนแปลง**: ทำ t-test → ตรวจสอบว่ายังมีความแตกต่างระหว่างกลุ่ม
3. **วิเคราะห์ผลกระทบ**: ทำ logistic regression → หา odds ratio ใหม่
4. **ประเมินสถานการณ์**: ใช้ odds เดิม × odds ratio → ประเมินผลกระทบต่อแต่ละโรงไฟฟ้า
5. **ตัดสินใจทางธุรกิจ**: ใช้ผลการวิเคราะห์วางแผนกลยุทธ์

**ประโยชน์ในการประยุกต์ใช้**:
- ประเมินผลกระทบของการเปลี่ยนแปลงได้อย่างรวดเร็วโดยไม่ต้องคำนวณใหม่ทั้งหมด
- ระบุโรงไฟฟ้าที่มีความเสี่ยงสูงจากการเปลี่ยนแปลงปัจจัยภายนอก
- วางแผนมาตรการเพื่อปรับปรุงประสิทธิภาพ (เช่น เพิ่ม operational_hrs)
- กำหนดเป้าหมายที่ชัดเจนในการรับมือกับการเปลี่ยนแปลงของต้นทุน

**การเก็บค่า odds ไว้ตั้งแต่เริ่มต้นช่วยให้องค์กรสามารถตอบสนองต่อการเปลี่ยนแปลงได้อย่างรวดเร็วและแม่นยำ**
