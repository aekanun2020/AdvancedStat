# การวิเคราะห์อนุกรมเวลาและการกำหนดพารามิเตอร์สำหรับโมเดล ARIMA

## บทนำ

การวิเคราะห์อนุกรมเวลาเป็นกระบวนการสำคัญในการศึกษาข้อมูลที่เปลี่ยนแปลงตามกาลเวลา โดยเฉพาะอย่างยิ่งเมื่อต้องการพยากรณ์ค่าในอนาคต เอกสารนี้นำเสนอเทคนิคการวิเคราะห์กราฟอนุกรมเวลาและวิธีการกำหนดพารามิเตอร์สำหรับโมเดล ARIMA รวมถึงโมเดลอื่นๆ ที่เกี่ยวข้อง

## 1. องค์ประกอบของอนุกรมเวลา

อนุกรมเวลาประกอบด้วยองค์ประกอบหลักสี่ประการที่ส่งผลต่อการเคลื่อนไหวของข้อมูล:

**แนวโน้ม (Trend)** คือการเปลี่ยนแปลงในระยะยาว แสดงทิศทางการเคลื่อนไหวของข้อมูลโดยรวม อาจเป็นแนวโน้มเพิ่มขึ้น ลดลง หรือคงที่

**ฤดูกาล (Seasonality)** คือรูปแบบที่เกิดซ้ำในช่วงเวลาที่แน่นอนและคาดการณ์ได้ เช่น รูปแบบรายวัน รายสัปดาห์ รายเดือน หรือรายปี

**วัฏจักร (Cyclical)** คือรูปแบบขึ้นลงในระยะยาวที่ไม่มีความถี่ที่แน่นอน มักเกี่ยวข้องกับวัฏจักรทางเศรษฐกิจ และมีระยะเวลายาวกว่าฤดูกาล

**ความไม่สม่ำเสมอ (Irregular)** คือความผันผวนแบบสุ่มที่ไม่สามารถอธิบายด้วยองค์ประกอบอื่น เกิดจากปัจจัยที่ไม่สามารถคาดเดาหรือควบคุมได้

## 2. กรณีศึกษา: ข้อมูลการผลิตไฟฟ้า

### 2.1 ลักษณะของข้อมูล

ข้อมูลที่ใช้ในการวิเคราะห์คือข้อมูลการผลิตไฟฟ้าในช่วงปี 2020-2023 ซึ่งเกิดจากการจำลองด้วยโค้ดที่สร้างองค์ประกอบต่างๆ ได้แก่ แนวโน้มการเติบโต 3% ต่อปี รูปแบบฤดูกาลรายปี (สูงในฤดูร้อนและฤดูหนาว) รูปแบบรายวัน (สูงในช่วงกลางวัน ต่ำในช่วงกลางคืน) รูปแบบรายสัปดาห์ (ต่ำในวันหยุดสุดสัปดาห์) วัฏจักรเศรษฐกิจประมาณ 3 ปี และเหตุการณ์พิเศษต่างๆ เช่น การซ่อมบำรุงและเหตุฉุกเฉิน

### 2.2 การวิเคราะห์เปรียบเทียบวันทำงานกับวันหยุด

การวิเคราะห์ Box Plot แสดงให้เห็นความแตกต่างระหว่างการผลิตไฟฟ้าในวันทำงานและวันหยุด:

กำลังการผลิตเฉลี่ยในวันทำงานอยู่ที่ 1041.91 MW สูงกว่าวันหยุดซึ่งอยู่ที่ 964.39 MW คิดเป็นความแตกต่าง 7.44% วันทำงานมีค่ามัธยฐานสูงกว่าและมีค่าผิดปกติมากกว่า แต่ทั้งสองประเภทวันมีช่วงการกระจายตัวที่ใกล้เคียงกัน

ความแตกต่างนี้แสดงให้เห็นถึงรูปแบบฤดูกาลรายสัปดาห์ที่ชัดเจน ซึ่งควรคำนึงถึงในการสร้างโมเดล โดยอาจใช้ค่า s = 7 สำหรับ SARIMA หรือเพิ่มตัวแปรหุ่น "weekend" ในโมเดล SARIMAX

### 2.3 การวิเคราะห์องค์ประกอบของอนุกรมเวลา

การแยกองค์ประกอบของอนุกรมเวลาช่วยให้เข้าใจข้อมูลได้ลึกซึ้งขึ้น:

**ข้อมูลการผลิตไฟฟ้ารายวัน** แสดงรูปแบบขึ้นลงที่ชัดเจนในหลายระดับความถี่ พร้อมจุดผิดปกติที่เห็นเป็นการลดลงอย่างฉับพลันในบางช่วงเวลา

**องค์ประกอบแนวโน้ม** มีการเปลี่ยนแปลงทิศทางในระยะยาวที่ไม่เป็นเชิงเส้นตรง โดยเพิ่มขึ้นในช่วงต้นปี 2020 ถึงปลายปี 2020 ลดลงต่อเนื่องจากต้นปี 2021 ถึงต้นปี 2022 และเริ่มฟื้นตัวอีกครั้งหลังจากกลางปี 2022

**องค์ประกอบฤดูกาล** มีรูปแบบรายปีที่ชัดเจน โดยค่าสูงในช่วงต้นถึงกลางปี (มีนาคม-พฤษภาคม) และต่ำในช่วงปลายปี (กันยายน-พฤศจิกายน) นอกจากนี้ยังพบความแกว่งขนาดเล็กภายในแต่ละรอบใหญ่ซึ่งแสดงถึงรูปแบบรายสัปดาห์

**องค์ประกอบความไม่สม่ำเสมอ** แม้จะแยกองค์ประกอบหลักออกไปแล้ว ยังพบรูปแบบการแกว่งตัวเป็นจังหวะ มีค่าผิดปกติหลายจุดที่เด่นชัด ความผันผวนมีระดับที่ไม่คงที่ตลอดช่วงเวลา และการกระจายตัวที่ไม่เป็นแบบปกติ

## 3. การกำหนดพารามิเตอร์สำหรับโมเดล ARIMA

โมเดล ARIMA(p,d,q)(P,D,Q)s มีพารามิเตอร์หลายตัวที่ต้องกำหนดให้เหมาะสม:

### 3.1 การกำหนดค่า d (Regular Differencing)

จากการวิเคราะห์แนวโน้มในข้อมูลการผลิตไฟฟ้า ควรใช้ d = 1 เนื่องจากข้อมูลมีแนวโน้มที่ไม่คงที่ อย่างไรก็ตาม เนื่องจากแนวโน้มไม่เป็นเชิงเส้นตรงและมีการเปลี่ยนแปลงทิศทาง โมเดล ARIMA อาจไม่เหมาะสมที่สุดสำหรับข้อมูลนี้

### 3.2 การกำหนดค่า s (Seasonal Period)

จากการวิเคราะห์รูปแบบฤดูกาล ในกรณีนี้อาจต้องพิจารณาฤดูกาลหลายระดับ:

สำหรับการจับรูปแบบรายสัปดาห์ในข้อมูลรายวัน ควรใช้ s = 7

สำหรับการจับรูปแบบรายปีในข้อมูลรายวัน ควรใช้ s = 365

สำหรับข้อมูลรายชั่วโมง อาจใช้ s = 24 (รายวัน) หรือ s = 168 (รายสัปดาห์ คือ 24×7)

### 3.3 การกำหนดค่า D (Seasonal Differencing)

ควรใช้ D = 1 เนื่องจากความสูงของรูปแบบฤดูกาลมีการเปลี่ยนแปลงตามเวลา

### 3.4 การกำหนดค่า p, q, P, Q

การกำหนดค่าเหล่านี้ต้องอาศัยการวิเคราะห์กราฟ ACF (Autocorrelation Function) และ PACF (Partial Autocorrelation Function) หลังจากทำ differencing แล้ว ซึ่งในกรณีนี้ไม่มีกราฟดังกล่าว จึงไม่สามารถระบุค่าที่เหมาะสมได้

## 4. ข้อจำกัดของโมเดล ARIMA สำหรับข้อมูลที่มีความซับซ้อน

การวิเคราะห์ข้อมูลการผลิตไฟฟ้าเผยให้เห็นข้อจำกัดของโมเดล ARIMA ในหลายประเด็น:

**แนวโน้มไม่เป็นเชิงเส้น**: ARIMA ถูกออกแบบมาเพื่อรองรับแนวโน้มเชิงเส้น แต่ข้อมูลการผลิตไฟฟ้ามีแนวโน้มที่มีการเปลี่ยนแปลงทิศทาง ซึ่งการทำ differencing อาจไม่สามารถจัดการได้อย่างมีประสิทธิภาพ

**ฤดูกาลหลายระดับ**: SARIMA แบบมาตรฐานรองรับรูปแบบฤดูกาลเพียงระดับเดียว แต่ข้อมูลมีฤดูกาลทั้งรายวัน รายสัปดาห์ และรายปี ทำให้ต้องเลือกว่าจะจับรูปแบบฤดูกาลใดเป็นหลัก

**ค่าผิดปกติ**: ข้อมูลมีค่าผิดปกติจากเหตุการณ์พิเศษหลายจุด ซึ่ง ARIMA ไม่มีกลไกจัดการค่าผิดปกติโดยตรง ทำให้อาจส่งผลต่อความแม่นยำของโมเดล

**ความผันผวนไม่คงที่**: ความผันผวนของข้อมูลมีระดับที่เปลี่ยนแปลงตามเวลา (heteroskedasticity) ซึ่ง ARIMA มีสมมติฐานว่าความแปรปรวนของข้อมูลควรคงที่

## 5. โมเดลทางเลือกที่เหมาะสมกว่าสำหรับข้อมูลซับซ้อน

เมื่อพิจารณาข้อจำกัดของ ARIMA สำหรับข้อมูลการผลิตไฟฟ้า มีโมเดลทางเลือกหลายประเภทที่อาจให้ผลลัพธ์ที่ดีกว่า:

### 5.1 โมเดลที่รองรับแนวโน้มไม่เชิงเส้น

Prophet (Facebook) ออกแบบมาเพื่อรองรับแนวโน้มที่ไม่เป็นเชิงเส้น ฤดูกาลหลายระดับ และจัดการค่าผิดปกติได้อย่างมีประสิทธิภาพ

TBATS (Trigonometric seasonality, Box-Cox transformation, ARMA errors, Trend, and Seasonal components) สามารถจับรูปแบบฤดูกาลหลายระดับและแนวโน้มที่ซับซ้อนได้

การใช้ STL decomposition ร่วมกับ ARIMA โดยแยกองค์ประกอบแล้วใช้ ARIMA กับส่วนที่เหมาะสม

### 5.2 โมเดลไม่เชิงเส้น

เครือข่ายประสาทเทียมประเภท LSTM หรือ TCN เหมาะสำหรับการจับรูปแบบที่ซับซ้อนและไม่เชิงเส้น สามารถเรียนรู้ความสัมพันธ์ที่ซับซ้อนในข้อมูลได้

NeuralProphet ผสมผสานคุณสมบัติของ Prophet กับเครือข่ายประสาทเทียม ทำให้มีความยืดหยุ่นสูง

### 5.3 โมเดลผสม

การผสมผสาน SARIMA กับเครือข่ายประสาทเทียม ช่วยให้สามารถจับรูปแบบทั้งเชิงเส้นและไม่เชิงเส้นได้

SARIMAX ที่เพิ่มตัวแปรภายนอก เช่น ตัวแปรหุ่นสำหรับวันหยุดและเหตุการณ์พิเศษ ช่วยให้โมเดลสามารถรับมือกับเหตุการณ์ที่ทราบล่วงหน้าได้

### 5.4 โมเดลที่จัดการความผันผวนไม่คงที่

GARCH และอนุพันธ์ ออกแบบมาเพื่อจัดการกับความแปรปรวนที่เปลี่ยนแปลงตามเวลา

Robust Time Series Models ที่ทนทานต่อค่าผิดปกติ ช่วยลดผลกระทบจากค่าผิดปกติที่อาจทำให้โมเดลเบี่ยงเบน

## 6. แนวทางการสร้างโมเดลที่เหมาะสม

### 6.1 กระบวนการวิเคราะห์และสร้างโมเดล

การสร้างโมเดลอนุกรมเวลาที่มีประสิทธิภาพควรเริ่มจากการวิเคราะห์ข้อมูลเชิงสำรวจ ดูกราฟในหลายมาตราส่วนเวลา วิเคราะห์องค์ประกอบของอนุกรมเวลา และตรวจสอบค่าผิดปกติและเหตุการณ์พิเศษ

จากนั้นควรเตรียมข้อมูลโดยจัดการกับค่าสูญหาย ระบุและจัดการค่าผิดปกติ และแปลงข้อมูลตามความเหมาะสม เช่น การทำ log transformation

การเลือกโมเดลที่เหมาะสมต้องพิจารณาความซับซ้อนของข้อมูล เลือกระหว่าง ARIMA/SARIMA หรือโมเดลทางเลือก และเตรียมตัวแปรภายนอกที่เกี่ยวข้อง

สุดท้ายคือการทดสอบและประเมินโมเดลด้วยเทคนิค time series cross-validation เกณฑ์วัดประสิทธิภาพที่เหมาะสม และการตรวจสอบค่าคงเหลือ

### 6.2 การจัดการกับฤดูกาลหลายระดับ

มีหลายวิธีในการจัดการกับฤดูกาลหลายระดับ เช่น การใช้โมเดลที่รองรับฤดูกาลหลายระดับโดยตรง เช่น TBATS, Prophet, หรือ NeuralProphet

อีกวิธีคือการแยกองค์ประกอบด้วย STL decomposition และสร้างโมเดลแยกสำหรับแต่ละองค์ประกอบ หรือการใช้ตัวแปรภายนอกเพื่อจับรูปแบบฤดูกาล โดยสร้างตัวแปรหุ่นสำหรับวันในสัปดาห์ เดือน ฤดูกาล และวันหยุดพิเศษ

### 6.3 การจัดการกับแนวโน้มที่ไม่เป็นเชิงเส้น

การจัดการกับแนวโน้มที่ไม่เป็นเชิงเส้นอาจทำได้โดยใช้โมเดลที่รองรับแนวโน้มไม่เชิงเส้นโดยตรง เช่น Prophet, TBATS, หรือ State Space Models

หรืออาจแบ่งข้อมูลตามจุดเปลี่ยนทิศทางแนวโน้มและสร้างโมเดลแยกสำหรับแต่ละช่วง โดยอาจใช้เทคนิค change point detection

นอกจากนี้ยังสามารถใช้โมเดลไม่เชิงเส้น เช่น เครือข่ายประสาทเทียม หรือ Gradient Boosting Models หรือโมเดลผสมที่รวมทั้ง ARIMA และโมเดลไม่เชิงเส้น

## 7. บทสรุป

การวิเคราะห์ข้อมูลการผลิตไฟฟ้าชี้ให้เห็นว่า ข้อมูลอนุกรมเวลาในโลกจริงมักมีความซับซ้อนสูง ประกอบด้วยแนวโน้มที่ไม่เป็นเชิงเส้น ฤดูกาลหลายระดับ และเหตุการณ์พิเศษที่ทำให้เกิดค่าผิดปกติ

โมเดล ARIMA แบบดั้งเดิมมีข้อจำกัดในการจับรูปแบบที่ซับซ้อนเหล่านี้ โดยเฉพาะแนวโน้มที่ไม่เป็นเชิงเส้นและฤดูกาลหลายระดับ ทำให้โมเดลทางเลือกที่มีความยืดหยุ่นมากกว่า เช่น Prophet, TBATS หรือโมเดลผสม อาจให้ผลลัพธ์ที่ดีกว่า

การวิเคราะห์กราฟและการแยกองค์ประกอบของอนุกรมเวลามีความสำคัญอย่างยิ่งในการทำความเข้าใจข้อมูล ช่วยให้สามารถเลือกโมเดลและกำหนดพารามิเตอร์ที่เหมาะสมได้

ไม่มีโมเดลใดที่เหมาะสมที่สุดสำหรับทุกสถานการณ์ การเลือกโมเดลที่เหมาะสมขึ้นอยู่กับลักษณะเฉพาะของข้อมูล ความเข้าใจลึกซึ้งในข้อมูลและข้อจำกัดของแต่ละโมเดลจะช่วยให้สามารถเลือกวิธีการที่เหมาะสมที่สุดสำหรับข้อมูลเฉพาะนั้นๆ