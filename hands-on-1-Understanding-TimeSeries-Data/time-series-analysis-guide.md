# การวิเคราะห์กราฟเพื่อบ่งชี้ Seasonality และการกำหนดพารามิเตอร์ ARIMA

## 1. การใช้กราฟในการวิเคราะห์ Time Series

การวิเคราะห์กราฟเป็นขั้นตอนสำคัญในการระบุรูปแบบ (patterns) และองค์ประกอบฤดูกาล (seasonality) ในข้อมูลอนุกรมเวลา ซึ่งช่วยในการกำหนดพารามิเตอร์ที่เหมาะสมสำหรับโมเดล ARIMA/SARIMA

### 1.1 องค์ประกอบหลักของอนุกรมเวลา

1. **แนวโน้ม (Trend)** - การเปลี่ยนแปลงในระยะยาว
2. **ฤดูกาล (Seasonality)** - รูปแบบที่เกิดซ้ำในระยะเวลาที่แน่นอน
3. **วัฏจักร (Cyclical)** - รูปแบบขึ้นลงในระยะยาว แต่ไม่มีความถี่ที่แน่นอน
4. **ความไม่สม่ำเสมอ (Irregular)** - ความผันผวนแบบสุ่มที่ไม่สามารถอธิบายด้วยองค์ประกอบอื่น

### 1.2 กราฟและการวิเคราะห์ในหลายมาตราส่วนเวลา (Multi-scale)

การวิเคราะห์ข้อมูลในหลายมาตราส่วนเวลา ช่วยให้เห็นรูปแบบที่แตกต่างกัน:

- **กราฟระยะยาว (หลายปี)** - แสดงแนวโน้ม, วัฏจักร, และการเปลี่ยนแปลงฤดูกาลรายปี
- **กราฟรายปี** - แสดงรูปแบบฤดูกาลภายในปี และความแตกต่างระหว่างเดือน
- **กราฟรายเดือน** - แสดงรูปแบบรายสัปดาห์และรายวัน
- **กราฟรายสัปดาห์** - แสดงรูปแบบรายวันละเอียดยิ่งขึ้น
- **กราฟรายวัน** - แสดงรูปแบบรายชั่วโมงได้ชัดเจน

## 2. การบ่งชี้รูปแบบฤดูกาล (Seasonality)

### 2.1 ลักษณะของฤดูกาลที่ชัดเจน

ฤดูกาลที่ชัดเจนจะแสดงลักษณะดังนี้:
- มีรูปแบบซ้ำในช่วงเวลาคงที่และสม่ำเสมอ
- ความสูงของจุดสูงสุดและต่ำสุดในแต่ละรอบใกล้เคียงกัน
- มีจุดเปลี่ยนที่คาดเดาได้ (เช่น จุดสูงสุด-ต่ำสุดเกิดในช่วงเวลาเดียวกันของวัน/สัปดาห์/เดือน)

**ตัวอย่างรูปแบบฤดูกาลที่ชัดเจน:**
- **รายชั่วโมง**: ค่าสูงในช่วงกลางวัน (6-18 น.) และต่ำในช่วงกลางคืน
- **รายวัน**: ค่าสูงในวันธรรมดา (จ-ศ) และต่ำในวันหยุด (ส-อา)
- **รายเดือน**: ค่าสูงในฤดูร้อน (มี.ค.-พ.ค.) และฤดูหนาว (พ.ย.-ม.ค.) และต่ำในฤดูฝน (มิ.ย.-ต.ค.)

### 2.2 ลักษณะของฤดูกาลที่ไม่ชัดเจน

ฤดูกาลที่ไม่ชัดเจนจะแสดงลักษณะดังนี้:
- มีความผันผวนสูง ทำให้ยากที่จะระบุรูปแบบที่ซ้ำกัน
- จุดสูงสุดและต่ำสุดเกิดในช่วงเวลาที่ไม่แน่นอน
- ความสูงของจุดสูงสุดและต่ำสุดมีความแตกต่างมากในแต่ละรอบ
- มีเหตุการณ์พิเศษบ่อยที่ทำให้รูปแบบถูกรบกวน

### 2.3 การใช้กราฟค่าเฉลี่ย

กราฟค่าเฉลี่ยช่วยให้เห็นรูปแบบฤดูกาลได้ชัดเจนขึ้น:
- **แบ่งตามช่วงเวลา**: คำนวณค่าเฉลี่ยแยกตามชั่วโมง, วันในสัปดาห์, เดือน
- **ค่าเฉลี่ยเคลื่อนที่ (Moving Average)**: กรองความผันผวนระยะสั้นออกเพื่อให้เห็นรูปแบบระยะยาวชัดเจนขึ้น
- **Box Plots**: แสดงการกระจายตัวของข้อมูลในแต่ละช่วงเวลา

## 3. การบ่งชี้ความคงที่ (Stationarity)

### 3.1 การวิเคราะห์ความคงที่จากกราฟ

ข้อมูลที่มีความคงที่จะแสดงลักษณะดังนี้:
- **ค่าเฉลี่ยคงที่**: ข้อมูลแกว่งรอบค่าคงที่ ไม่มีแนวโน้มเพิ่มขึ้นหรือลดลง
- **ความแปรปรวนคงที่**: ความกว้างของการแกว่งตัวไม่เปลี่ยนแปลงมาก
- **ไม่มีวัฏจักรระยะยาว**: ไม่มีรูปแบบขึ้นลงในระยะยาวที่ไม่เกี่ยวกับฤดูกาล

### 3.2 การดู Simple Moving Average (SMA)

SMA ช่วยในการระบุความคงที่:
- **ข้อมูลคงที่**: SMA จะแกว่งรอบค่าคงที่ ไม่มีแนวโน้มชัดเจน
- **ข้อมูลไม่คงที่**: SMA จะมีแนวโน้มเพิ่มขึ้นหรือลดลงอย่างต่อเนื่อง

### 3.3 การใช้ค่าเฉลี่ยของความต่าง (Mean of Differences)

การคำนวณความต่างระหว่างข้อมูลติดกัน (differencing) และวิเคราะห์ค่าเฉลี่ย:
- **ค่าเฉลี่ยใกล้ศูนย์**: บ่งชี้ว่าข้อมูลหลังทำ differencing มีความคงที่
- **ค่าเฉลี่ยไม่ใกล้ศูนย์**: อาจต้องทำ differencing เพิ่ม

## 4. การวิเคราะห์ ACF และ PACF

### 4.1 Autocorrelation Function (ACF)

ACF แสดงความสัมพันธ์ระหว่างข้อมูล ณ เวลาต่างๆ:
- **ข้อมูลไม่คงที่**: ACF ลดลงอย่างช้าๆ (slow decay)
- **ข้อมูลคงที่**: ACF ลดลงอย่างรวดเร็ว (quick decay) หรือตัดหลังจาก lag ไม่กี่ตัว
- **ข้อมูลมีฤดูกาล**: ACF จะมีค่าสูงที่ lag ซึ่งเป็นความยาวของฤดูกาล (เช่น lag 24 สำหรับข้อมูลรายชั่วโมง)

### 4.2 Partial Autocorrelation Function (PACF)

PACF แสดงความสัมพันธ์โดยตรงระหว่างข้อมูลที่ห่างกัน k ช่วงเวลา:
- **AR(p) process**: PACF จะตัดหลัง lag p
- **MA(q) process**: ACF จะตัดหลัง lag q
- **ARMA(p,q) process**: ทั้ง ACF และ PACF ลดลงแบบหางยาว (tail off)

## 5. การกำหนดพารามิเตอร์ ARIMA(p,d,q)(P,D,Q)s

### 5.1 การกำหนดค่า d (Regular Differencing)

- **d = 0**: เมื่อข้อมูลมีความคงที่อยู่แล้ว ไม่มีแนวโน้ม
- **d = 1**: เมื่อข้อมูลมีแนวโน้มเชิงเส้น (linear trend)
- **d = 2**: เมื่อข้อมูลมีแนวโน้มเป็นพาราโบลา (quadratic trend)

วิธีการตัดสินใจ:
1. ดูกราฟข้อมูลดูว่ามีแนวโน้มหรือไม่
2. ตรวจสอบ SMA ว่ามีแนวโน้มหรือไม่
3. คำนวณค่าเฉลี่ยของความต่าง (หลังทำ differencing) ว่าใกล้ศูนย์หรือไม่
4. ใช้การทดสอบทางสถิติ (เช่น ADF, KPSS)

### 5.2 การกำหนดค่า s (Seasonal Period)

- **s = 24**: สำหรับข้อมูลรายชั่วโมงที่มีฤดูกาลรายวัน
- **s = 7**: สำหรับข้อมูลรายวันที่มีฤดูกาลรายสัปดาห์
- **s = 12**: สำหรับข้อมูลรายเดือนที่มีฤดูกาลรายปี
- **s = 4**: สำหรับข้อมูลรายไตรมาสที่มีฤดูกาลรายปี

วิธีการตัดสินใจ:
1. ดูกราฟแยกตามช่วงเวลา (เช่น ชั่วโมง, วัน, เดือน)
2. ตรวจสอบ ACF สำหรับค่าสูงที่ lag ที่สอดคล้องกับรอบฤดูกาล

### 5.3 การกำหนดค่า D (Seasonal Differencing)

- **D = 0**: เมื่อข้อมูลไม่มีแนวโน้มตามฤดูกาล
- **D = 1**: เมื่อรูปแบบฤดูกาลมีการเปลี่ยนแปลงค่าเฉลี่ยตามเวลา

วิธีการตัดสินใจ:
1. ตรวจสอบว่าความสูงของจุดสูงสุดและต่ำสุดในแต่ละรอบฤดูกาลมีการเปลี่ยนแปลงตามเวลาหรือไม่
2. ใช้การทดสอบทางสถิติเฉพาะสำหรับฤดูกาล (เช่น OCSB, CH test)

### 5.4 การกำหนดค่า p และ q (Regular Component)

- **p**: จำนวนค่า AR terms
- **q**: จำนวนค่า MA terms

วิธีการตัดสินใจ:
1. ตรวจสอบ ACF และ PACF หลังจากทำ differencing แล้ว
2. ถ้า ACF ตัดที่ lag q และ PACF ลดลงแบบหางยาว → MA(q)
3. ถ้า PACF ตัดที่ lag p และ ACF ลดลงแบบหางยาว → AR(p)
4. ถ้าทั้ง ACF และ PACF ลดลงแบบหางยาว → ARMA(p,q)

### 5.5 การกำหนดค่า P และ Q (Seasonal Component)

- **P**: จำนวนค่า seasonal AR terms
- **Q**: จำนวนค่า seasonal MA terms

วิธีการตัดสินใจ:
1. ตรวจสอบ ACF และ PACF ที่ lag เป็นจำนวนเท่าของ s
2. ใช้หลักการเดียวกับการกำหนดค่า p และ q

## 6. แนวทางการวิเคราะห์แบบบูรณาการ

### 6.1 ขั้นตอนการวิเคราะห์ที่แนะนำ

1. **ดูกราฟในหลายมาตราส่วนเวลา** เพื่อเข้าใจภาพรวมและรายละเอียด
2. **วิเคราะห์รูปแบบฤดูกาล** และระบุความยาวของฤดูกาล (s)
3. **ตรวจสอบความคงที่** และพิจารณาความจำเป็นในการทำ differencing (d, D)
4. **วิเคราะห์ ACF และ PACF** เพื่อกำหนดค่า p, q, P, Q
5. **ตัดสินใจแบบบูรณาการ** โดยใช้หลายวิธีร่วมกัน และพิจารณาทั้งลักษณะกราฟและผลการทดสอบทางสถิติ

### 6.2 ข้อควรระวัง

- **ระวัง Overfitting**: การกำหนดค่าพารามิเตอร์มากเกินไปอาจทำให้โมเดลไม่สามารถทำนายข้อมูลใหม่ได้ดี
- **เลือกใช้ค่า d และ D น้อยที่สุดเท่าที่จำเป็น**: การทำ differencing มากเกินไปอาจทำให้เกิดปัญหาในโมเดล
- **พิจารณาโมเดลทางเลือก**: บางกรณีอาจต้องใช้โมเดลที่ซับซ้อนกว่า SARIMA เช่น โมเดลที่มีฤดูกาลหลายระดับ หรือโมเดลที่รวมตัวแปรภายนอก

## 7. กรณีศึกษา: การวิเคราะห์ข้อมูลการผลิตไฟฟ้า

เมื่อวิเคราะห์ข้อมูลการผลิตไฟฟ้าที่มีรูปแบบฤดูกาลชัดเจนทั้ง 3 ระดับ:

### 7.1 การพิจารณากราฟค่าเฉลี่ยตามชั่วโมง
- รูปแบบรายวันชัดเจน: สูงในช่วงกลางวัน (ชั่วโมงที่ 5-10) และต่ำในช่วงกลางคืน (ชั่วโมงที่ 18-23)
- บ่งชี้ว่าควรใช้ s = 24 สำหรับฤดูกาลรายวัน

### 7.2 การพิจารณากราฟค่าเฉลี่ยตามวันในสัปดาห์
- รูปแบบรายสัปดาห์ชัดเจน: สูงในวันทำงาน (จันทร์-ศุกร์) และต่ำในวันหยุด (เสาร์-อาทิตย์)
- บ่งชี้ว่าอาจต้องใช้ s = 7 หรือ s = 168 (7×24) สำหรับฤดูกาลรายสัปดาห์
- หรืออาจเพิ่มตัวแปรหุ่นสำหรับวันหยุดสุดสัปดาห์ใน SARIMAX

### 7.3 การพิจารณากราฟค่าเฉลี่ยตามเดือน
- รูปแบบรายปีชัดเจน: สูงในช่วงฤดูร้อน (มีนาคม-พฤษภาคม) และฤดูหนาว (พฤศจิกายน-ธันวาคม) และต่ำในช่วงฤดูฝน (กรกฎาคม-กันยายน)
- บ่งชี้ว่าควรคำนึงถึงฤดูกาลรายปีในโมเดล

### 7.4 การตัดสินใจเลือกโมเดล
จากรูปแบบที่ชัดเจนทั้ง 3 ระดับ แนะนำให้ใช้:
1. **SARIMA** ที่มีพารามิเตอร์ฤดูกาลเหมาะสม หรือ
2. **โมเดลที่รองรับฤดูกาลหลายระดับ** เช่น TBATS หรือ Prophet
3. **SARIMAX** ที่เพิ่มตัวแปรหุ่นสำหรับวันหยุดสุดสัปดาห์

## บทสรุป

การวิเคราะห์กราฟอย่างละเอียดช่วยให้สามารถระบุรูปแบบฤดูกาลและความคงที่ของข้อมูล ซึ่งเป็นขั้นตอนสำคัญในการเลือกพารามิเตอร์ที่เหมาะสมสำหรับโมเดล ARIMA/SARIMA การพิจารณาข้อมูลในหลายมาตราส่วนเวลา และการใช้หลายเทคนิคร่วมกัน จะช่วยให้การตัดสินใจมีความแม่นยำมากขึ้น และนำไปสู่โมเดลที่มีประสิทธิภาพในการพยากรณ์

---
