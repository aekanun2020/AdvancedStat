# สรุป Lab 2: การทำข้อมูลให้คงที่ (Stationarity) และ Moving Averages

## วัตถุประสงค์ของแล็บ
Lab 2 เป็นการเรียนรู้เกี่ยวกับการวิเคราะห์ Time Series ขั้นกลาง โดยเฉพาะในบริบทของการผลิตไฟฟ้า โดยมีวัตถุประสงค์เพื่อ:
1. เข้าใจและตรวจสอบความคงที่ (Stationarity) ของข้อมูล Time Series
2. เรียนรู้เทคนิคการแปลงข้อมูลให้คงที่ด้วยวิธีต่างๆ
3. ศึกษาและประยุกต์ใช้เทคนิค Moving Averages
4. วิเคราะห์ Autocorrelation และ Partial Autocorrelation เพื่อระบุรูปแบบความสัมพันธ์ในข้อมูล

## การตรวจสอบและทำให้ข้อมูลคงที่
ในแล็บนี้ เราได้ตรวจสอบความคงที่ของข้อมูลการผลิตไฟฟ้าด้วย Augmented Dickey-Fuller Test (ADF test) และใช้เทคนิคต่างๆ เพื่อแปลงข้อมูลให้คงที่:

1. **การหาความแตกต่าง (Differencing)**: 
   - First-order differencing ช่วยกำจัดแนวโน้ม (Trend) ในข้อมูล
   - ผลการทดสอบ ADF หลังทำ First-order differencing แสดงว่าข้อมูลมีความคงที่มากขึ้น

2. **การแปลงลอการิทึม (Log Transformation)**:
   - ช่วยปรับปรุงกรณีที่ข้อมูลมีความแปรปรวนเพิ่มขึ้นตามเวลา
   - การรวม Log Transformation กับ Differencing ให้ผลลัพธ์ที่ดีมาก

3. **การปรับฤดูกาล (Seasonal Differencing)**:
   - Seasonal Differencing (ช่วง 365 วัน) ช่วยกำจัดรูปแบบฤดูกาลรายปี
   - การรวม First-order และ Seasonal Differencing ให้ผลลัพธ์ดีที่สุดในการทำให้ข้อมูลคงที่

## การใช้เทคนิค Moving Averages

### 1. Simple Moving Average (SMA)
- SMA ช่วงเวลาสั้น (24 ชั่วโมง) แสดงความผันผวนในระยะสั้น
- SMA ช่วงเวลาปานกลาง (7 วัน) ช่วยปรับเรียบข้อมูลรายวัน
- SMA ช่วงเวลายาว (30 วัน) แสดงแนวโน้มระยะยาวได้ชัดเจนที่สุด

### 2. Weighted Moving Average (WMA)
- การให้น้ำหนักมากกับข้อมูลล่าสุด (Increasing Weights) ทำให้ WMA ตอบสนองต่อการเปลี่ยนแปลงล่าสุดได้ไวกว่า SMA
- การให้น้ำหนักเท่ากัน (Equal Weights) ทำให้ WMA มีลักษณะเหมือน SMA

### 3. Exponentially Weighted Moving Average (EWMA)
- EWMA ให้น้ำหนักแบบเอกซ์โพเนนเชียลกับข้อมูลล่าสุด
- EWMA span=7 ตอบสนองไวต่อการเปลี่ยนแปลงระยะสั้น
- EWMA span=30 แสดงแนวโน้มระยะยาวได้ดี แต่ยังคงรักษารายละเอียดดีกว่า SMA 30 วัน

## การประยุกต์ใช้ Moving Averages

### 1. การพยากรณ์อย่างง่าย
- การใช้ค่าล่าสุดของ Moving Average เป็นค่าพยากรณ์สำหรับช่วงเวลาถัดไป
- ผลการเปรียบเทียบแสดงว่า EWMA (span=7) ให้ค่าความผิดพลาดในการพยากรณ์ต่ำกว่า SMA 7 วันและ SMA 30 วัน
- MAE ของ EWMA (span=7) อยู่ที่ประมาณ 54 MW เทียบกับ SMA 7 วันที่ 62 MW

### 2. การตรวจจับความผิดปกติ (Anomaly Detection)
- ใช้ Moving Average และส่วนเบี่ยงเบนมาตรฐานในการกำหนดขอบเขตบนและล่าง
- สามารถตรวจจับความผิดปกติได้ประมาณ 4.26% ของข้อมูลทั้งหมด
- ความผิดปกติพบมากในช่วงเวลาที่มีการซ่อมบำรุงและเหตุการณ์ฉุกเฉิน (เมษายน-กรกฎาคม 2021)
- พบความผิดปกติมากในช่วงเวลา 5-7 นาฬิกา ซึ่งเป็นช่วงที่มีการผลิตไฟฟ้าสูงสุด

## การวิเคราะห์ Autocorrelation และ Partial Autocorrelation

- **ACF ของข้อมูลดิบ**: แสดงความสัมพันธ์เชิงฤดูกาลที่ชัดเจน (รายวันและรายปี)
- **PACF ของข้อมูลดิบ**: แสดงความสัมพันธ์ที่มีนัยสำคัญที่ lag 1, 2, 24 และ 48
- **ACF หลัง First-order Differencing**: ลดความสัมพันธ์ระยะยาว แต่ยังคงมีรูปแบบรายวัน
- **PACF หลัง First-order + Seasonal Differencing**: แสดงความสัมพันธ์ที่ลดลงอย่างมาก บ่งชี้ว่าข้อมูลมีความคงที่มากขึ้น

จากการวิเคราะห์ ACF และ PACF สามารถระบุพารามิเตอร์ที่เหมาะสมสำหรับโมเดล ARIMA ได้ดังนี้:
- ข้อมูลดิบ: ARIMA(2,0,2)
- หลัง First-order Differencing: ARIMA(1,1,1)
- หลัง Seasonal Differencing: SARIMA(1,0,1)(0,1,0,365)
- หลัง First-order + Seasonal Differencing: SARIMA(1,1,1)(0,1,0,365)

## บทเรียนที่ได้รับ

1. **ความสำคัญของความคงที่**: ข้อมูลที่คงที่เป็นพื้นฐานสำคัญสำหรับการพยากรณ์ที่แม่นยำ การรวม First-order และ Seasonal Differencing ให้ผลลัพธ์ที่ดีที่สุดในการทำให้ข้อมูลการผลิตไฟฟ้าคงที่
  
2. **ประสิทธิภาพของ Moving Averages**: 
   - SMA เหมาะสำหรับการแสดงแนวโน้มระยะยาว
   - EWMA มีประสิทธิภาพดีในการตอบสนองต่อการเปลี่ยนแปลง และให้ผลการพยากรณ์ที่ดีกว่า SMA
   - การเลือกขนาดหน้าต่าง (Window) ที่เหมาะสมมีความสำคัญต่อประสิทธิภาพของ Moving Averages

3. **การตรวจจับความผิดปกติ**: Moving Average สามารถนำมาประยุกต์ใช้ในการตรวจจับความผิดปกติของระบบไฟฟ้าได้อย่างมีประสิทธิภาพ โดยเฉพาะในช่วงที่มีการซ่อมบำรุงหรือเหตุฉุกเฉิน

4. **การแปลผล ACF และ PACF**: การวิเคราะห์กราฟ ACF และ PACF เป็นเครื่องมือสำคัญในการระบุพารามิเตอร์ที่เหมาะสมสำหรับโมเดล ARIMA ซึ่งจะนำไปสู่การพยากรณ์ที่แม่นยำยิ่งขึ้น

## การประยุกต์ใช้ในการวางแผนการผลิตไฟฟ้า

1. **การวางแผนซ่อมบำรุง**: สามารถใช้เทคนิคการตรวจจับความผิดปกติเพื่อระบุอุปกรณ์ที่อาจต้องการการบำรุงรักษาล่วงหน้า

2. **การพยากรณ์ระยะสั้น**: EWMA สามารถใช้ในการพยากรณ์ความต้องการไฟฟ้าระยะสั้น (1-7 วัน) ได้อย่างมีประสิทธิภาพ เพื่อปรับแผนการผลิตให้เหมาะสม

3. **การระบุรูปแบบการใช้ไฟฟ้า**: การวิเคราะห์ความผิดปกติตามช่วงเวลาช่วยให้เข้าใจรูปแบบการใช้ไฟฟ้าและเตรียมพร้อมสำหรับช่วงเวลาที่มีความต้องการสูงหรือมีความผันผวน

4. **การเตรียมแบบจำลองขั้นสูง**: ความเข้าใจเกี่ยวกับความคงที่ของข้อมูลและการวิเคราะห์ ACF/PACF เป็นพื้นฐานสำคัญในการพัฒนาแบบจำลอง ARIMA/SARIMA ที่มีประสิทธิภาพ

## ขั้นตอนต่อไป
จากพื้นฐานที่ได้เรียนรู้ใน Lab 2 นี้ ขั้นตอนต่อไปคือการศึกษาเทคนิคการพยากรณ์ที่ซับซ้อนขึ้น ได้แก่ Exponential Smoothing และการพัฒนาโมเดล ARIMA/SARIMA สำหรับการพยากรณ์ความต้องการไฟฟ้าอย่างแม่นยำ